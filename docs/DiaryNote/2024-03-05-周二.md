## 提问
当 printf 传入-2147483648时候, 编译器将其自动转换为了 long 类型, 占用了内存空间中的 8 个字节, 即变为了 FFFF FFFF 8000 0000的形式存储在内存当中, 而实际上, 4 个字节是足矣存储下0x80000000这个数字的, 在进行格式化处理的时候, 能够成功处理到0x80000000, 但是下一个内存位置中存储的数据是0xffffffff, 好巧不巧的是下一个参数是字符串类型的, 它以字符数组的形式存储在内存当中, 因此这个参数应该是指向目标字符串的指针, 在格式化处理的认为0xffffffff 地址中存储的就是想要的字符串, 很显然, 0xffffffff 是一个非法的地址, 必然报错

提问: 请问在使用格式化字符串时候, 应该如何正确得处理如下的情况, 代码如下
`sprintf (buf, "%d  %s  %d  \n",-2147483648, "hello", -2147483648);`
这行代码特殊的地方在于, `-2147483648` 的 16 进制是 `0x80000000`, 是 `int` 类型所能表示的最小数字, 但是 `-2147483648` 会被编译器处理成表达式 `-(2147483648)`, 但是对于 32 位补码来说, `2147483648` 是超出了所能表达的最大数字 `2147483647` 的, 因此编译器会将这个 32 位的数转换成 64 位的 `long long`, 在运算完成后进行传参, 此时真正传入的参数是 `long long` 类型的 ` 0xFFFF FFFF 8000 0000 `, 但是我的 sprintf 并不能处理好这种情况: 在进行可变参数处理时候, 程序通过 ` fmt ` 中的 ` %d ` 认为接下来进行格式化的参数是一个 ` int ` 类型的变量, 因此使用 ` va_arg(ap, int) ` 获得下一个可变参数, 此时可以得到 ` 0x8000 0000 `, 仅读取了其中的低 32 位. 这看起来似乎是正确的, 但接下来问题就出现了, 下一个格式化变量是一个字符串, 当程序读取到 ` %s ` 时候, 理所应当的认为传入的是一个指向字符串的指针, 此时调用 ` va_arg(ap, char *) ` 获得到的是 ` 0xffff ffff `!! 这显然是一个非法的内存地址, 在此进行访存时候就出现了问题, ` nemu ` 检测到非法的内存访问, 就立即停止了. 在我的格式化字符串的实现中并不能处理好这种情况, 在此请教一下各位.

![image.png](https://jiunian-pic-1310185536.cos.ap-nanjing.myqcloud.com/picgo20240305170245.png)



## REID-web
### 地图相关
- 使用百度地图 api: [百度地图API文档](https://lbsyun.baidu.com/index.php?title=jspopularGL)
	- 需要的功能: 
		- 点: 用于标记监控, 可交互, 用于打开监控
		- 线: 根据模型检索的结果, 在地图上绘制出轨迹

### 交互
- 用户通过上传控件上传查询的人物图片, 需要在后端保存路径至数据库, 用于后续调用 `search` 进行查询
- 查询时: 对监控目录下的所有监控视频遍历一遍, 将每个返回的结果都打上标记: `监控id + 时间`, 标记可以以文件名的形式, 并且生成 `key-values` 对存储在数据库中, 